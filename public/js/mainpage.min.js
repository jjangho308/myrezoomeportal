{"code":"function change_default_cert(e){$(\".change_cert\").remove();var t=getTxidList();for(var o in t)try{var r=getData(t[o]),a=r.dftYn,i=r.subid,s=r.data;if(e==i){var c='<tr class=\"change_cert\">';c=(c+=\"<td>\")+\"<div id=change_cert_\"+e+' class=\"abc-radio\">',c=(c=\"Y\"==a?c+\"<input id=change_cert_\"+r.txid+' type=\"radio\" name=\"spec-change\" checked>':c+\"<input id=change_cert_\"+r.txid+' type=\"radio\" name=\"spec-change\">')+\"<label for=change_cert_\"+r.txid+\"></label>\",c+=\"</div>\",c=(c=(c=(c=(c=(c+=\"</td>\")+\"<td>\"+formatDate(s.ctestday)+\"</td>\")+\"<td>\"+s.userid+\"</td>\")+\"<td>\"+s.name+\"</td>\")+\"<td>\"+a+\"</td>\")+\"<td>\"+s.rating+\"</td>\",c+=\"<td></td>\",c+=\"</tr>\",$(\"#spec-change-table\").append(c)}}catch(e){continue}$(\"#spec-change-dialog\").modal(\"show\")}function delete_private_record(e){$.ajax({type:\"POST\",url:\"/record/\"+e,headers:{Authorization:client_authorization},beforeSend:function(){$(\".private-spec-body\").remove()},success:function(e){getPrivateRecords()}})}function getPrivateRecords(){$.ajax({type:\"GET\",url:\"/record/list\",headers:{Authorization:client_authorization},beforeSend:function(){$(\".private-spec-body\").remove()},success:function(e){e.result.forEach(function(e,t){var o=JSON.parse(e.data);o.certPrvtId=e.certPrvtId,formatter[e.subCd](o)})}})}function request_agent(){setTxidList([]),getRSAKey();var e=KEYUTIL.getJWKFromKey(rsakey_pub);$.ajax({type:\"POST\",url:\"/client\",headers:{Authorization:client_authorization},data:JSON.stringify({cmd:\"SearchRecord\",args:{pkey:\"asdfasdf\",update:!1,n:e.n,e:e.e}}),beforeSend:function(){$(\".spec-body\").remove()},success:function(e){setSocket(e.mid),clientsocket_listener(),setTimeout(function(){$(\".spec-body-loading\").hide(),$(\".spec-body-default\").show(),refreshview(null)},1500)},contentType:\"application/json\"})}function refreshview(e){$(\".spec-body-loading\").hide();var t={},o=\"\";if(null!=e)for(var r in e)try{var a=(s=e[r]).subid;if(\"Y\"==s.dftYn)(c=s.data).chkid=s.txid,t[c.subid=a]=c,o=a;else if(o!=a){(c=s.data).chkid=s.txid,t[c.subid=a]=c,o=a}}catch(e){continue}else{$(\".spec-body\").remove();var i=getTxidList();for(var r in i)try{var s;a=(s=getData(i[r])).subid;if(\"Y\"==s.dftYn)(c=s.data).chkid=s.txid,t[c.subid=a]=c,o=a;else if(o!=a){var c;(c=s.data).chkid=s.txid,t[c.subid=a]=c,o=a}}catch(e){console.error(JSON.stringify(e));continue}}for(var r in t){o=t[r].subid;formatter[o](t[r])}}function clientsocket_listener(){socket.on(\"SearchResult\",function(e){console.log(\"=============clientsocket_listener=================\"),console.log(e),console.log(\"===================================================\");for(var t=JSON.parse(e),o=t.key,r=t.iv,a=base64toHEX(o),i=KJUR.crypto.Cipher.decrypt(a,rsakey_prv),s=(t.orgcode,0);s<t.records.length;s++){t.records[s].subid;var c=CryptoJS.AES.decrypt(t.records[s].data,CryptoJS.enc.Base64.parse(i),{iv:CryptoJS.enc.Base64.parse(r)});console.log(c.toString(CryptoJS.enc.Utf8)),t.records[s].data=c.toString(CryptoJS.enc.Utf8);try{setData(t.records[s])}catch(e){console.log(e)}}refreshview(t.records)})}function firstLogin(){$(\".section-1 button\").click(function(){$(\".section-1\").css(\"display\",\"none\"),$(\".section-3\").css(\"display\",\"block\"),setTimeout(function(){$(\".ko-progress-circle\").attr(\"data-progress\",20),$(\".percentage span\").text(\"20%\")},100),setTimeout(function(){$(\".ko-progress-circle\").attr(\"data-progress\",50),$(\".percentage span\").text(\"50%\")},1e3),setTimeout(function(){$(\".ko-progress-circle\").attr(\"data-progress\",100),$(\".percentage span\").text(\"100%\"),setTimeout(function(){$(\".percentage span\").css(\"display\",\"none\"),$(\".section-3 button\").prop(\"disabled\",!1),$(\".percentage img\").css(\"display\",\"block\")},1e3)},2e3)}),$(\".section-3 button\").click(function(){$(\"#initial-dialog .close-modal\").click()}),$(\"#initial-dialog\").modal(\"show\")}function setSocket(e){socket.close(),socket=io(),socket.emit(\"SetSocket\",{mid:e})}function getTargetdivid(e){if(\"RCCNF0001\"==e);else if(\"RCLPT0005\"==e)return\"spec_forign_lang\"}$(document).ready(function(){$(\".study-period\").datepicker(),$(\".study-period\").datepicker(\"option\",\"dateFormat\",\"yy-mm-dd\"),client_token=getCookie(\"JWT\"),client_authorization=\"Bearer \"+client_token,$(\".spec-body-loading\").show(),$(\".spec-body-default\").hide(),$(\"#header-mycert\").click(function(){$(\"#header-myresume\").css({border:\"none\",\"font-weight\":\"normal\"}),$(\"#header-resume-store\").css({border:\"none\",\"font-weight\":\"normal\"}),$(this).css({\"border-bottom\":\"solid 5px #4c80f1\",\"font-weight\":\"bold\"}),window.location=\"certs\"}),$(\"#header-resume-store\").click(function(){$(\"#header-myresume\").css({border:\"none\",\"font-weight\":\"normal\"}),$(\"#header-mycert\").css({border:\"none\",\"font-weight\":\"normal\"}),$(this).css({\"border-bottom\":\"solid 5px #4c80f1\",\"font-weight\":\"bold\"}),window.location=\"resumes\"}),$(\"#header-myresume\").click(function(){$(\"#header-mycert\").css({border:\"none\",\"font-weight\":\"normal\"}),$(\"#header-resume-store\").css({border:\"none\",\"font-weight\":\"normal\"}),$(this).css({\"border-bottom\":\"solid 5px #4c80f1\",\"font-weight\":\"bold\"}),window.location=\"main\"}),$(\"#education-add-dialog .add-span\").click(function(){console.log(\"#education-add-dialog .add-span clicked\"),$(\"#major-div\").append('<div class=\"error-range major-div\"><div class=\"select-100\"><select name=\"select-1\"><option value=\"1\">전공</option><option value=\"2\">부전공</option><option value=\"3\">복수전공</option></select></div><div class=\"select-100\"><select name=\"select-2\"><option value=\"volvo\">학사</option><option value=\"saab\">석사</option></select></div><input type=\"text\" class=\"major add-major\" placeholder=\"전공을 입력해주세요. Ex) 컴퓨터 공학\"><img src=\"/img/myresume/close-white.svg\"/><div class=\"error-message\">전공을 입력해주세요.</div></div>'),$(\"select\").selectize()}),$(\"#education-add-dialog .confirm-btn\").click(function(){var o=!1;\"\"==$(\"#school\").next().find(\".item\").text()?($(\"#school\").next().find(\".selectize-input\").addClass(\"error\"),$(\"#school\").next().next().css(\"display\",\"block\"),o=!0):($(\"#school\").next().find(\".selectize-input\").removeClass(\"error\"),$(\"#school\").next().next().css(\"display\",\"none\")),$(\".major\").each(function(){var e=$(this),t=e.closest(\".error-range\");if(\"\"==e.val())e.addClass(\"error\"),t.find(\".items \").addClass(\"error\"),t.find(\".error-message\").css(\"display\",\"block\"),o=!0;else{t=e.closest(\".error-range\");e.removeClass(\"error\"),t.find(\".items \").removeClass(\"error\"),t.find(\".error-message\").css(\"display\",\"none\")}});var e=$(\"#education-add-dialog .study-period\"),t=e.closest(\".error-range\");\"\"==e[0].value||\"\"==e[1].value?(e.addClass(\"error\"),t.find(\"button\").addClass(\"error\"),t.find(\".items\").addClass(\"error\"),t.find(\".error-message\").css(\"display\",\"block\"),o=!0):(e.removeClass(\"error\"),t.find(\"button\").removeClass(\"error\"),t.find(\".items\").removeClass(\"error\"),t.find(\".error-message\").css(\"display\",\"none\"));t=$(\"#score\").closest(\".error-range\");\"\"==$(\"#score\").val()?($(\"#score\").addClass(\"error\"),t.find(\".items\").addClass(\"error\"),t.find(\".error-message\").css(\"display\",\"block\"),o=!0):($(\"#score\").removeClass(\"error\"),t.find(\".items\").removeClass(\"error\"),t.find(\".error-message\").css(\"display\",\"none\")),0==o&&($(\"#education-add-dialog .close-modal\").click(),$(\"#alarm-div span\").text(\"학력이 추가되었습니다.\"),$(\"#alarm-div\").css(\"display\",\"block\"),$(\"#alarm-div\").css(\"margin-right\",\"-108px\"))}),$(\"#career-add-dialog .confirm-btn\").click(function(){var e={company:$(\"#career-company\").val(),position:$(\"#career-position\").val(),role:$(\"#career-role\").val(),startdate:$(\"#career-startdate\").val(),enddate:$(\"#career-enddate\").val(),status:$(\"#career-status\").val()},t=JSON.stringify(e);$.ajax({type:\"POST\",url:\"/record\",headers:{Authorization:client_authorization},data:JSON.stringify({orgCd:\"ETC\",subCd:\"CPR\",data:t}),error:function(e,t,o){console.error(\"/record Error : \"+o),console.error(e.responseText)},success:function(e){$(\"#career-add-dialog .close-modal\").click(),$(\"#alarm-div span\").text(\"사용자 이력 수기 입력했다.\"),$(\"#alarm-div\").css(\"display\",\"block\"),$(\".private-spec-body\").remove(),getPrivateRecords()},contentType:\"application/json\"})}),$(\"#language-add-dialog .confirm-btn\").click(function(){var e={lang:$(\"#langadd_lang\").val(),name:$(\"#language-name\").val(),score:$(\"#language-grade\").val(),startdate:$(\"#langadd_startdate\").val(),enddate:$(\"#langadd_enddate\").val(),expiry:$(\"#langadd_expireYn\").is(\":checked\")},t=JSON.stringify(e);$.ajax({type:\"POST\",url:\"/record\",headers:{Authorization:client_authorization},data:JSON.stringify({orgCd:\"EDI\",subCd:\"LPT\",data:t}),error:function(e,t,o){console.error(\"/record Error : \"+o),console.error(e.responseText)},success:function(e){$(\"#language-add-dialog .close-modal\").click(),$(\"#alarm-div span\").text(\"사용자 이력 수기 입력했다.\"),$(\"#alarm-div\").css(\"display\",\"block\"),$(\".private-spec-body\").remove(),getPrivateRecords()},contentType:\"application/json\"})}),$(\"#cert-add-dialog .confirm-btn\").click(function(){var e={name:$(\"#cert-name\").val(),grade:$(\"#cert-grade\").val(),startdate:$(\"#certadd_startdate\").val(),enddate:$(\"#certadd_enddate\").val(),expiry:$(\"#certadd_expireYn\").is(\":checked\")},t=JSON.stringify(e);$.ajax({type:\"POST\",url:\"/record\",headers:{Authorization:client_authorization},data:JSON.stringify({orgCd:\"STI\",subCd:\"OGC\",data:t}),error:function(e,t,o){console.error(\"/record Error : \"+o),console.error(e.responseText)},success:function(e){$(\"#cert-add-dialog .close-modal\").click(),$(\"#alarm-div span\").text(\"사용자 이력 수기 입력했다.\"),$(\"#alarm-div\").css(\"display\",\"block\"),$(\".private-spec-body\").remove(),getPrivateRecords()},contentType:\"application/json\"})}),$(\"#spec-change-dialog .confirm-btn\").click(function(){$(\".abc-radio input:radio\").each(function(){if($(this).is(\":checked\")){var i=$(this).attr(\"id\").substring(12),s=$(this).parent().attr(\"id\").substring(12);$.ajax({type:\"POST\",url:\"/certs/setDefault\",headers:{Authorization:client_authorization},data:JSON.stringify({txid:i,subid:s}),success:function(e){$(\"#spec-change-dialog .close-modal\").click(),$(\"#alarm-div span\").text(\"정상적으로 이력이 변경되었습니다.\"),$(\"#alarm-div\").css(\"display\",\"block\"),$(\"#alarm-div\").css(\"margin-right\",\"-142px\");var t=getTxidList();for(var o in t)try{var r=getData(t[o]),a=(r.dftYn,r.subid);r.data;s==a&&(i==r.txid?r.dftYn=\"Y\":r.dftYn=\"N\",r.data=JSON.stringify(r.data),setData(r))}catch(e){console.error(e);continue}refreshview()},error:function(e,t,o){console.error(\"Set Default Error : \"+o),console.error(e.responseText)},contentType:\"application/json\"})}})}),$(\".spec-detail-div\").click(function(){$(\".spec-detail-div input:checkbox\").each(function(e){$(this).is(\":checked\")?$(this).closest(\".spec-body\").css({border:\"solid 1px #4c80f1\",\"border-radius\":\"4px\",\"background-color\":\"rgba(76, 128, 241, 0.05)\"}):$(this).closest(\".spec-body\").css({border:\"none\",\"border-bottom\":\"solid 1px #dfe5ef\",\"background-color\":\"white\"});var t=$(\".spec-detail-div input:checkbox:checked\").length;0==t?($(\"#select-footer\").hide(),$(\"#main-footer\").css(\"margin-bottom\",\"0px\")):($(\"#select-footer span:nth-child(2)\").text(t+\"건의\"),$(\"#select-footer\").show(),$(\"#main-footer\").css(\"margin-bottom\",\"71px\"))})}),$(\"#cert-issue-button\").click(function(){var a=!1;$(\".spec-detail-div input:checkbox\").each(function(e){if($(this).is(\":checked\")){var t=$(this).attr(\"id\"),o=sessionStorage.getItem(t),r={};r.txid=t,r.record=JSON.parse(o),$.ajax({type:\"POST\",url:\"/certs\",headers:{Authorization:client_authorization},data:JSON.stringify({cert:r}),beforeSend:function(){if(!a){a=!0;var e=0;$(\"#cert-line-dialog #circle-\"+e).css(\"background-color\",\"#4a90e2\");var t=setInterval(function(){$(\"#cert-line-dialog #circle-\"+e).css(\"background-color\",\"#dadada\"),5<(e+=1)&&(e=0),$(\"#cert-line-dialog #circle-\"+e).css(\"background-color\",\"#4a90e2\")},1e3);setTimeout(function(){$(\"#cert-line-dialog .close-modal\").click(),$(\"#alarm-div\").css(\"display\",\"block\"),$(\"#alarm-div\").css(\"margin-right\",\"-224px\"),$(\"#select-footer\").hide(),$(\"#alarm-div span\").text(\"증명서 발급이 완료되었습니다. 증명서보관함에서 확인해주세요.\"),$(\".spec-detail-div input:checkbox\").attr(\"checked\",!1),$(\".spec-body\").css({border:\"none\",\"border-bottom\":\"solid 1px #dfe5ef\",\"background-color\":\"white\"}),clearInterval(t),setTimeout(function(){$(\"#alarm-div\").hide(),a=!1},1e3)},3e3)}},success:function(e){},error:function(e,t,o){console.error(\"/Issue cert error : \"+o),console.error(e.responseText)},contentType:\"application/json\"})}})}),$(\"#refresh_record\").click(function(){$(\".spec-body-loading\").show(),$(\".spec-body-default\").hide(),getRSAKey();var e=KEYUTIL.getJWKFromKey(rsakey_pub);setTxidList([]),$.ajax({type:\"POST\",url:\"/client\",headers:{Authorization:client_authorization},beforeSend:function(){$(\".spec-body\").remove(),$(\".spec-body-default\").css(\"display\",\"none\"),$(\".spec-body-loading\").css(\"display\",\"block\")},data:JSON.stringify({cmd:\"SearchRecord\",args:{pkey:\"asdfasdf\",update:!0,n:e.n,e:e.e}}),error:function(e,t,o){console.error(\"Search record Error : \"+o),console.error(e.responseText)},success:function(e){setSocket(e.mid),clientsocket_listener(),setTimeout(function(){$(\".spec-body-loading\").hide(),$(\".spec-body-default\").show()},1500)},contentType:\"application/json\"})})}),window.onload=function(){socket=io();var e=getTxidList();if(1<e.length){for(var t=[],o=0;o<e.length;o++)try{var r=getData(e[o]);t.push(r)}catch(e){console.error(e);continue}$(\".spec-body-default\").show(),refreshview(t),$(\"#initial-dialog .close-modal\").click()}else genRsaKey(function(e,t){e?console.error(JSON.stringify(e)):t&&request_agent()});getPrivateRecords()};"}