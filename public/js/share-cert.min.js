var certdata,certUrl,certId,verifyisclicked=0;function verify(e){var r=SHA256(e),t="";try{if(certdata.encrypted){var o=certdata.iv,i=certdata.data,s=CryptoJS.AES.decrypt(i,CryptoJS.enc.Hex.parse(r),{iv:CryptoJS.enc.Base64.parse(o)});t=JSON.parse(s.toString(CryptoJS.enc.Utf8))}else t=certdata.data;$(".main-container").css("display","none"),$(".loading-container").css("display","block");var a=0;$("#circle-"+a).css("background-color","#4a90e2");var c=setInterval(function(){$("#circle-"+a).css("background-color","#dadada"),2<(a+=1)&&(clearInterval(c),a=0,certformatter[t.subid](t.data),$("#cert-verify").css("display","none"),$("#cert-viewer").css("display","block")),$("#circle-"+a).css("background-color","#4a90e2")},1e3)}catch(e){$("input").css("border","solid 1px #f59188"),$(".error-message").css("display","block")}}function nexledgerInfoView(o){$.ajax({type:"POST",url:"/nexledger/get_txinfo",contentType:"application/json",data:JSON.stringify({txid:o}),error:function(e,r,t){$("#nexledger-txid-info-dialog").css("display","none"),console.error("Nexledger Connection Error : "+t),console.error(e.responseText),nexledgerErr=1},success:function(e){console.log(e),$("#tx_id").text(o);for(var r="",t=0;t<e.result.fromaddress.length;t++)r=r+e.result.fromaddress[t]+"<br>";$("#fromaddress").html(r),r="";for(t=0;t<e.result.toaddress.length;t++)r=r+e.result.toaddress[t]+"<br>";$("#toAddress").html(r),$("#total_volume").text(e.result.total_volume),$("#total_output").text(e.result.output),$("#txsize").text(e.result.txsize+" byte"),r="";for(t=0;t<e.result.input_script.length;t++)r=r+e.result.input_script[t]+"<br>";$("#input_script").html(r),$("#input_script").css("height","175px"),r="";for(t=0;t<e.result.output_script.length;t++)r=r+e.result.output_script[t]+"<br>";$("#output_script").html(r),$("#output_script").css("height","200px"),$(".nexledger-txid-info-dialog-close").click(function(e){$("#nexledger-txid-info-dialog .close-modal").click()})}})}function setData(e){var r=JSON.parse(e);certId=(certdata=r).certId,certUrl=r.url}$(document).ready(function(){$("#cert-confirm-btn").click(function(){verify($("#cert-confirm-pw").val())}),$("#popup-dialog a").click(),$("#cert-viewer").css("display","none");try{if(0==certdata.encrypted){json_decrypted=certdata.data,$(".main-container").css("display","none"),$(".loading-container").css("display","block");var e=0;$("#circle-"+e).css("background-color","#4a90e2");var r=setInterval(function(){$("#circle-"+e).css("background-color","#dadada"),2==(e+=1)&&($("#cert-verify").css("display","none"),$("#cert-viewer").css("display","block"),certformatter[json_decrypted.subid](json_decrypted.data),clearInterval(r)),$("#circle-"+e).css("background-color","#4a90e2")},1e3)}}catch(e){console.error(e)}$("#btn_print").click(function(e){generateQRCode(),$(".header").hide(),$(".main-body-footer").hide(),$(".main-body-footer-decription").hide(),$(".qr-container").show();var r=document.querySelector("html"),t=$(".outer-container"),o="";t.each(function(e,r){o+=$(this).html()});var i=document.createElement("DIV");i.className="print-div",r.appendChild(i),i.innerHTML=o,document.body.style.display="none",window.print(),document.body.style.display="block",i.remove(),$(".header").show(),$(".main-body-footer").show(),$(".main-body-footer-decription").show(),$(".qr-container").hide()}),$(".main-body-footer-right").click(function(e){if(0==verifyisclicked){$(".main-body-footer-right").css({width:"100px",height:"40px","border-radius":"4px","background-color":"#e2e8f0"}),verifyisclicked=1;var r='<div class="footer-verify-1">';r+='<div class="footer-verify-left">STEP1</div>',r+='<div class="footer-verify-center">Nexledger에 기록된 Transaction ID를 조회하는중입니다.</div>',r+='<div class="footer-verify-right"><div class="verify-loader"><div class="verify-loader-item"></div><div class="verify-loader-item"></div><div class="verify-loader-item"></div></div></div>',r+="</div>",$(".main-body-footer").append(r),$("html").animate({scrollTop:$(".main-body-footer").offset().top},600),nexledgerInfoView($(".main-body-footer-6").text()),setTimeout(function(){$(".footer-verify-1 > .footer-verify-right").html('<img src="/img/certviewer/shape.svg" class="Shape">');var e='<div class="footer-verify-2">';e+='<div class="footer-verify-left">STEP2</div>',e+='<div class="footer-verify-center">Hash 데이터를 비교하고 있습니다.</div>',e+='<div class="footer-verify-right"><div class="verify-loader"><div class="verify-loader-item"></div><div class="verify-loader-item"></div><div class="verify-loader-item"></div></div></div>',e+="</div>",$(".main-body-footer").append(e),$("html").animate({scrollTop:$(".main-body-footer").offset().top},600),setTimeout(function(){$(".footer-verify-2 > .footer-verify-right").html('<img src="/img/certviewer/shape.svg" class="Shape">');var e='<div class="footer-verify-3">';e+='<div class="footer-verify-left">STEP3</div>',e+='<div class="footer-verify-center">결과를 정리하고 있습니다.</div>',e+='<div class="footer-verify-right"><div class="verify-loader"><div class="verify-loader-item"></div><div class="verify-loader-item"></div><div class="verify-loader-item"></div></div></div>',e+="</div>",$(".main-body-footer").append(e),$("html").animate({scrollTop:$(".main-body-footer").offset().top},600),setTimeout(function(){$(".footer-verify-3 > .footer-verify-right").html('<img src="/img/certviewer/shape.svg" class="Shape">');var e='<div class="footer-verify-4">';e+='<div class="footer-verify-left">RESULT</div>',e+='<div class="footer-verify-center">정상적인 데이터로 확인되었습니다.</div>',e+='<div id="txinfoget-bt" class="footer-verify-right"><a href="#nexledger-txid-info-dialog" rel="modal:open">트랜잭션 조회</a></div>',e+="</div>",$(".main-body-footer").append(e),$("html").animate({scrollTop:$(".main-body-footer").offset().top},600),$(".main-body-footer-right").css({"background-color":"#7ed321"}),$(".main-body-footer-right-button1").text("검증완료"),$(".footer-verify-4 > .footer-verify-center").css({color:"#7ed321"}),$("#txinfoget-bt").click(function(e){1==nexledgerErr&&alert("Nexledger Admin Connection ERR")})},1e3)},1e3)},1e3)}else alert("이미 진행중입니다")})});