var socket,client_token,rsakey_prv,rsakey_pub;function leadingZeros(e,r){var t="";if((e=e.toString()).length<r)for(i=0;i<r-e.length;i++)t+="0";return t+e}function getTimeStamp(){var e=new Date;return leadingZeros(e.getFullYear(),4)+"-"+leadingZeros(e.getMonth()+1,2)+"-"+leadingZeros(e.getDate(),2)+" "+leadingZeros(e.getHours(),2)+":"+leadingZeros(e.getMinutes(),2)+":"+leadingZeros(e.getSeconds(),2)}function getCookie(e){for(var r=e+"=",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var a=t[n];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(r))return a.substring(r.length,a.length)}return""}function setData(e){console.log(e.data),e.data=JSON.parse(e.data),sessionStorage.setItem(e.txid,JSON.stringify(e)),addTxidList(e.txid)}function genRsaKey(r){if(window.Worker){var t=new Worker("js/generate_keypair_worker.js");return t.postMessage([0]),t.onmessage=function(e){try{e.data?(setRSAKey(JSON.parse(e.data)),r(null,e)):r(new Error("Couldn't generate RSA Keypair"))}catch(e){console.error(JSON.stringify(e)),r(new Error("Couldn't generate RSA Keypair"))}finally{t.terminate()}}}return window.Promise?new Promise(function(e,r){try{e(KEYUTIL.generateKeypair("RSA",2048))}catch(e){r(e)}}).then(function(e){return{rsakey_pub:KEYUTIL.getJWKFromKey(e.pubKeyObj),rsakey_prv:KEYUTIL.getJWKFromKey(e.prvKeyObj)}}).then(function(e){setRSAKey(e),r(null,e)}).catch(function(e){console.error(e)}):setTimeout(function(){try{rsaKeypair=KEYUTIL.generateKeypair("RSA",2048),rsaKeypair={rsakey_pub:KEYUTIL.getJWKFromKey(rsaKeyPair.pubKeyObj),rsakey_prv:KEYUTIL.getJWKFromKey(rsaKeyPair.prvKeyObj)},setRSAKey(rsaKeypair),r&&r(null,rsaKeypair)}catch(e){r&&r(e)}},0)}function setRSAKey(e){sessionStorage.setItem("rsa_prv",JSON.stringify(e.rsakey_prv)),sessionStorage.setItem("rsa_pub",JSON.stringify(e.rsakey_pub))}function getRSAKey(){var e=sessionStorage.getItem("rsa_pub"),r=sessionStorage.getItem("rsa_prv");null!=e&&null!=r||genRsaKey();var t=JSON.parse(r),n=JSON.parse(e);rsakey_prv=KEYUTIL.getKey(t),rsakey_pub=KEYUTIL.getKey(n)}function getData(e){var r=sessionStorage.getItem(e)||"{}";try{return JSON.parse(r)}catch(e){return console.log(e),{}}}function addTxidList(e){var r=getTxidList();for(var t in r)if(r[t]==e)return;r.push(e),setTxidList(r)}function setTxidList(e){sessionStorage.setItem(client_token,e)}function getTxidList(){var e=sessionStorage.getItem(client_token);if(null==e){setTxidList([]),e=sessionStorage.getItem(client_token)}var r=e.split(",");for(var t in r)""==r[t]&&r.splice(t,1);return r}function SHA256(e){function C(e,r){var t=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(t>>16)<<16|65535&t}function _(e,r){return e>>>r|e<<32-r}function L(e,r){return e>>>r}return function(e){for(var r="0123456789abcdef",t="",n=0;n<4*e.length;n++)t+=r.charAt(e[n>>2]>>8*(3-n%4)+4&15)+r.charAt(e[n>>2]>>8*(3-n%4)&15);return t}(function(e,r){var t,n,a,o,i,s,u,g,c,f,y,l,d,p,h,S,K,m,v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),b=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),T=new Array(64);e[r>>5]|=128<<24-r%32,e[15+(r+64>>9<<4)]=r;for(var k=0;k<e.length;k+=16){t=b[0],n=b[1],a=b[2],o=b[3],i=b[4],s=b[5],u=b[6],g=b[7];for(var A=0;A<64;A++)T[A]=A<16?e[A+k]:C(C(C(_(m=T[A-2],17)^_(m,19)^L(m,10),T[A-7]),_(K=T[A-15],7)^_(K,18)^L(K,3)),T[A-16]),c=C(C(C(C(g,_(S=i,6)^_(S,11)^_(S,25)),(h=i)&s^~h&u),v[A]),T[A]),f=C(_(p=t,2)^_(p,13)^_(p,22),(y=t)&(l=n)^y&(d=a)^l&d),g=u,u=s,s=i,i=C(o,c),o=a,a=n,n=t,t=C(c,f);b[0]=C(t,b[0]),b[1]=C(n,b[1]),b[2]=C(a,b[2]),b[3]=C(o,b[3]),b[4]=C(i,b[4]),b[5]=C(s,b[5]),b[6]=C(u,b[6]),b[7]=C(g,b[7])}return b}(function(e){for(var r=Array(),t=0;t<8*e.length;t+=8)r[t>>5]|=(255&e.charCodeAt(t/8))<<24-t%32;return r}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var r="",t=0;t<e.length;t++){var n=e.charCodeAt(t);n<128?r+=String.fromCharCode(n):(127<n&&n<2048?r+=String.fromCharCode(n>>6|192):(r+=String.fromCharCode(n>>12|224),r+=String.fromCharCode(n>>6&63|128)),r+=String.fromCharCode(63&n|128))}return r}(e)),8*e.length))}function currentDate(e){e=new Date(e.toString().replace(/GMT.*/,"")+" UTC");$("#updateTime").html("업데이트 : "+e.format("yyyy-MM-dd(KS) HH:mm"))}function hexToBase64(e){return btoa(String.fromCharCode.apply(null,e.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))}function base64toHEX(e){var r=window.atob(e),t="";for(i=0;i<r.length;i++){var n=r.charCodeAt(i).toString(16);t+=2==n.length?n:"0"+n}return t.toUpperCase()}function formatDate(e){if(8==e.length)return[a=e.substring(0,4),t=e.substring(4,6),n=e.substring(6,8)].join("-");if(14==e.length)return[a=e.substring(0,4),t=e.substring(7,9),n=e.substring(12,14)].join("-");var r=new Date(e),t=""+(r.getMonth()+1),n=""+r.getDate(),a=r.getFullYear();return t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),[a,t,n].join("-")}Date.prototype.format=function(e){if(!this.valueOf())return" ";var r=["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],t=["일","월","화","수","목","금","토"],n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=this;return e.replace(/(yyyy|yy|MM|dd|KS|KL|ES|EL|HH|hh|mm|ss|a\/p)/gi,function(e){switch(e){case"yyyy":return o.getFullYear();case"yy":return(o.getFullYear()%1e3).zf(2);case"MM":return(o.getMonth()+1).zf(2);case"dd":return o.getDate().zf(2);case"KS":return t[o.getDay()];case"KL":return r[o.getDay()];case"ES":return a[o.getDay()];case"EL":return n[o.getDay()];case"HH":return o.getHours().zf(2);case"hh":return((h=o.getHours()%12)?h:12).zf(2);case"mm":return o.getMinutes().zf(2);case"ss":return o.getSeconds().zf(2);case"a/p":return o.getHours()<12?"오전":"오후";default:return e}})},String.prototype.string=function(e){for(var r="",t=0;t++<e;)r+=this;return r},String.prototype.zf=function(e){return"0".string(e-this.length)+this},Number.prototype.zf=function(e){return this.toString().zf(e)};